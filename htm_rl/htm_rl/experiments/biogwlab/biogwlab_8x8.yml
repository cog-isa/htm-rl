verbosity: &verbosity 1

# ============== seed =================
random_seed_setter: !RandomSeedSetter
  seed: &seed 8713

# =========== environment =============
env_generator: !BioGwLabEnvGenerator &env_generator
  seed: *seed
  size: 5
  n_areas: 3
  density: .25
  verbosity: *verbosity

.env_dimensions:
  n_states: &n_states 64
  n_actions: &n_actions 4

.experiment_config:
  n_episodes_all_fixed: &n_episodes_all_fixed 10
  n_initial_states: &n_initial_states 1
  n_terminal_states: &n_terminal_states 1
  n_environments: &n_environments 1
  max_steps: &max_steps 40

# test run results processing
run_results_processor: !RunResultsProcessor
  env_name: biogwlab_8x8
  moving_average: 1
  verbosity: *verbosity
  test_dir:                   # leave empty for default behavior - output to the config's dir

# =========== encoder =================
.state_bits_pre: &state_bits_pre 200
.state_bits_post: &state_bits_post 220

#.observation_encoder: &observation_encoder !VectorSdrEncoder
#  name: state
#  n_elements: *state_bits_pre
#  n_categories: 2
#  default_format: full

.state_spatial_pooler: &state_spatial_pooler !SpatialPooler
  input_size: *state_bits_pre
  output_size: *state_bits_post
  potential_synapses_ratio: .8
  sparsity: .1
  synapse_permanence_deltas: [.1, .02]
  connected_permanence_threshold: .5
  boost_strength: 4
  boost_sliding_window: 300
  expected_normal_overlap_frequency: .005
  seed: *seed
  min_activation_threshold: 1

sa_sdr_encoder: &sa_sdr_encoder !SaSdrEncoder
  state_encoder: !RandomSdrEncoderSp
    name: state
    random_encoder:
    spatial_pooler: *state_spatial_pooler
  action_encoder: !IntSdrEncoder
    name: action
    n_values: *n_actions
    value_bits: 5
    activation_threshold: 4
    default_format: full

.sa_total_bits: &q_sa_total_bits 300
.q_sa_spatial_pooler: &q_sa_spatial_pooler !SpatialPooler
  input_size: 240
  output_size: *q_sa_total_bits
  potential_synapses_ratio: .8
  sparsity: .1
  synapse_permanence_deltas: [ .1, .02 ]
  connected_permanence_threshold: .5
  boost_strength: 4
  boost_sliding_window: 300
  expected_normal_overlap_frequency: .005
  seed: *seed
  min_activation_threshold: 1

# =========== Agents and Runners ==============
.base_mcts_actor_critic: &base_mcts_actor_critic
  cells_sdr_size: *state_bits_post
  update_cell_ratio: 1.
  discount_factor: .95
  learning_rate: .998
  seed: *seed
  online: True

ucb_experiment_runner: !UcbExperimentRunner
  env_generator: *env_generator
  n_episodes_all_fixed: *n_episodes_all_fixed
  n_initial_states: *n_initial_states
  n_terminal_states: *n_terminal_states
  n_environments: *n_environments
  max_steps: *max_steps
  verbosity: *verbosity

  agent: !UcbAgent
    n_actions: *n_actions
    encoder: *sa_sdr_encoder
    spatial_pooler: *q_sa_spatial_pooler

    ucb_actor_critic: !UcbActorCritic
      <<: *base_mcts_actor_critic
      cells_sdr_size: *q_sa_total_bits
